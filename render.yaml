services:
  # Web Service
  - type: web
    name: clothing-price-tracker
    env: docker
    dockerfilePath: ./Dockerfile
    plan: starter
    region: oregon
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: JWT_SECRET
        generateValue: true
      - key: PORT
        value: 3000
      - key: SMTP_USERNAME
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: SMTP_SERVER
        value: smtp.gmail.com
      - key: SMTP_PORT
        value: 587
      - key: FROM_EMAIL
        sync: false
      - key: FROM_NAME
        value: Price Tracker
      - key: RUST_LOG
        value: clothing_price_tracker=info,tower_http=debug
    healthCheckPath: /
    autoDeploy: true

  # PostgreSQL Database
  - type: pserv
    name: clothing-tracker-db
    env: docker
    plan: starter
    region: oregon
    dockerfilePath: ./Dockerfile
    envVars:
      - key: POSTGRES_USER
        value: postgres
      - key: POSTGRES_PASSWORD
        generateValue: true
      - key: POSTGRES_DB
        value: price_tracker

databases:
  - name: price-tracker-postgres
    plan: starter
    region: oregon
